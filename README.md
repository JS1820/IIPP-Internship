
# Enhancing Tpot-CE honeypot with MITRE Engage Goal: 'Affect'

## Overview  

### Introduction

Welcome to the detailed documentation of the 3-month internship at NYCU AI College in Taiwan, where the main focus was on Active Defense implementation in Tpot CE Honeypot. This research work was conducted in ANT Lab starting from September-1, 2023, under the guidance of **Professor. Ren-Hung Hwang**, Dean of AI College, NYCU. I am grateful to IIPP for providing me with this enriching opportunity.


## Goals

1. **Month 1: MITRE Engage Study and Honeypot Exposure**
   - Conduct an in-depth study of MITRE Engage documents, specifically focusing on the 'Affect' goal.
   - Selection of specific actions under 'Affect' goal for subsequent implementation.

2. **Month 2: Study SSH Honeypots and Choose a Honeypot for Implementation**
   - In-depth study of various SSH honeypots available in the cybersecurity landscape.
   - Choose one honeypot for implementation in the Tpot CE Honeypot.
   - Further refinement of selected actions for implementation.

3. **Month 3: Choose and Implement any 4 Activities**
   - Implement the chosen SSH honeypot within the Tpot CE Honeypot.
   - Develop and execute the Lures activity by configuring the honeypot to create deceptive pathways.
   - Implement the proactive defense mechanism for the Baseline activity using Python code.
   - Set up a postfix email server for the Email Manipulation activity and integrate Suricata rules.
   - Achieve Attack Vector Migration by isolating and analyzing potential malicious email attachments.

## Monthly Work Breakdown (Structured as Directories for this Repository)

### Month 1: MITRE Engage Study and Honeypot Exposure --  Refer [/Month-1/](https://github.com/0hex7/IIPP-Internship/tree/main/Month-1) 

- **MITRE Engage Study**
  - Detailed analysis of specific actions under the 'Affect' goal.
  - Documentation of 'Affect' goal actions for future implementation.


### Month 2: Study and Choose any one SSH Honeypot  --  Refer [/Month-2/](https://github.com/0hex7/IIPP-Internship/tree/main/Month-2) 

- **SSH Honeypot Study**
  - In-depth study of various SSH honeypots, considering features, community support, and suitability.
  - Selection of one SSH honeypot for further implementation.

- **Selecting Actions for 'Affect' goal of MITRE Engage**
  - Selection of actions based on the chosen SSH honeypot's capabilities.

### Month 3: Implement 4 Activities from 'Affect' goal --  Refer [/Month-3/](https://github.com/0hex7/IIPP-Internship/tree/main/Month-3) 

- **Lures Activity**
  - Configuration of the chosen honeypot to simulate an attacker's traversal through deceptive pathways.

- **Baseline Activity**
  - Development and implementation of a proactive defense mechanism using Python code.

- **Email Manipulation Activity**
  - Setup of a postfix email server, acquisition of a domain at no-ip.com, and integration of Suricata rules for effective threat detection in incoming emails.

- **Attack Vector Migration**
  - Isolation of potential malicious email attachments in a separate environment for thorough analysis.

## Tools Used

1. **Tpot CE Honeypot**
   - Choosen honeypot for the overall implementation.
   - Configured to be utilised efficiently for our research work.

2. **Kibana**
   - Utilized for log analysis, intrusion detection, and vulnerability detection.

3. **Postfix Email Server**
   - Set up to facilitate the Email Manipulation activity and enable the analysis of malicious content in emails.

4. **Suricata IDS**
   - Deployment for real-time intrusion detection.
   - Enhancement of the ability to capture and analyze malicious activities.

5. **Porcmail**   
   - Used along with Postfix mail server, to implement Email Manipulation & Attack Vector Migration.
     
And many more tools, which were used during this Internship are recorded in Tools directory --   Refer [/Tools/ ](https://github.com/0hex7/IIPP-Internship/tree/main/Tools) 


## Implementation Details

### Overall Implementation of the Actions under 'Affect' goal --   Refer [/Month-3/](https://github.com/0hex7/IIPP-Internship/tree/main/Month-3) 

- **Lures Activity Implementation**
  - Postfix email server setup and configuration.
  - Acquisition of a domain at no-ip.com for realistic email scenarios.
  - Integration of Suricata rules for enhanced threat detection.

- **Baseline Activity Implementation**
  - Isolation of potential malicious email attachments.
  - Detailed documentation of the separate environment for analysis.

- **Email Manipulation Activity Implementation**
  - Postfix email server setup and configuration.
  - Acquisition of a domain at no-ip.com for realistic email scenarios.
  - Integration of Suricata rules for enhanced threat detection.

- **Attack Vector Migration Implementation**
  - Isolation of potential malicious email attachments.
  - Detailed documentation of the separate environment for analysis.

## Research Findings

### Cutting-edge Active Defense:

#### 1. **Dynamic Honeypot Integration:**
   - Adapted honeypot configurations dynamically for robust threat detection.

#### 2. **Behavioral Analysis for Anomaly Detection:**
   - Integrated custom rules into Suricata IDS for identifying novel threats.

### Practical Insights:

#### 1. **Real-world Active Defense:**
   - Implemented active defense measures, enhancing threat visibility in live environments.

#### 2. **Collaborative Threat Intelligence:**
   - Emphasized the value of collaborative threat intel sharing for collective defense.

These findings drive practical advancements in active defense, addressing modern cybersecurity challenges efficiently.




## GitHub Repository Structure

### Documentaion and Code and Resources

- **/Month-1/** : Documents related to the MITRE Engage study.
- **/Month-2/** : Documents related to Honeypots and related code.
- **/Month-3/** : Code and configurations for implementing all 4 of the 'Affect' goal actions in the Honeypot.
  
- **/Research-papers/** : Detailed summaries and insights from relevant research papers.
- **/Reference-materials/** : All other reference material is published in this
  
- **/Tools/** : Additional resources on the tools used during the internship.


## Acknowledgments

I express sincere gratitude to Professor Ren-Hung Hwang for exceptional mentorship, guidance, and continuous support throughout the 3-month internship. Special thanks to seniors at the ANT Lab, specially @[haward79](https://github.com/haward79/) for his collaboration and insights that significantly enriched the overall experience.

I express my gratitude to [IIPP](https://iipp.tw/) for the enriching opportunity to work under Prof. Hwang, visit Taiwan, and learn invaluable lessons in cybersecurity.

I extend my thanks to Presidency University, Bangalore, for granting me the opportunity to pursue this internship and fostering an environment conducive to learning.
